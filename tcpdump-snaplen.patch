--- tcpdump-3.7.1-orig/interface.h	2002-01-21 09:39:58.000000000 -0200
+++ tcpdump-3.7.1/interface.h	2002-05-31 14:53:23.000000000 -0300
@@ -137,6 +137,7 @@
 
 /* True if  "l" bytes of "var" were captured */
 #define TTEST2(var, l) ((const u_char *)&(var) <= snapend - (l))
+#define TTEST2(var, l) ((l < 65535) && ((u_char *)&(var) <= snapend - (l)))
 
 /* True if "var" was captured */
 #define TTEST(var) TTEST2(var, sizeof(var))
